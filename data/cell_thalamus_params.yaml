# Cell Thalamus v1 Phase 0 Parameters
# Defines stress axes, compound mappings, and morphology channel responses

# Stress axes and their effects on Cell Painting channels
stress_axes:
  oxidative:
    description: "Oxidative stress (ROS production)"
    channels:
      er: 0.3        # ER stress secondary to oxidative damage
      mito: 1.5      # Strong mitochondrial response
      nucleus: 0.2   # Nuclear condensation
      actin: -0.4    # Cytoskeleton disruption
      rna: 0.1       # Translation stress

  er_stress:
    description: "Endoplasmic reticulum stress (protein folding)"
    channels:
      er: 2.0        # Primary ER response
      mito: 0.5      # Secondary mitochondrial stress
      nucleus: 0.3   # Nuclear stress response
      actin: 0.0     # Minimal cytoskeleton change
      rna: 0.8       # UPR activation

  mitochondrial:
    description: "Mitochondrial dysfunction"
    channels:
      er: 0.4        # ER-mito crosstalk
      mito: 2.5      # Primary mitochondrial response
      nucleus: 0.5   # Metabolic stress signaling
      actin: -0.3    # Energy-dependent structure loss
      rna: 0.2       # Metabolic adaptation

  dna_damage:
    description: "DNA damage and cell cycle arrest"
    channels:
      er: 0.1        # Minimal ER stress
      mito: 0.3      # Apoptotic priming
      nucleus: 1.8   # Primary nuclear response
      actin: -0.2    # Cell cycle arrest morphology
      rna: 0.6       # DNA damage response genes

  proteasome:
    description: "Proteasome inhibition (protein aggregation)"
    channels:
      er: 1.2        # Protein accumulation in ER
      mito: 0.4      # Secondary stress
      nucleus: 0.7   # Nuclear protein aggregates
      actin: -0.5    # Aggresome formation
      rna: 1.0       # Stress response transcription

  microtubule:
    description: "Microtubule disruption"
    channels:
      er: 0.2        # Minimal ER stress
      mito: 0.3      # Mitotic arrest
      nucleus: 1.0   # Mitotic catastrophe
      actin: 0.8     # Cytoskeletal reorganization
      rna: 0.1       # Minimal transcriptional change

# Compound panel - maps to stress axes
compounds:
  tBHQ:
    name: "tert-Butylhydroquinone"
    stress_axis: "oxidative"
    intensity: 0.8  # Moderate morphology effect
    ec50_uM: 30.0   # EC50 at 30 µM gives gentler viability curve
    hill_slope: 1.2  # Gentle curve so middle doses show clear effects

  H2O2:
    name: "Hydrogen Peroxide"
    stress_axis: "oxidative"
    intensity: 1.2
    ec50_uM: 100.0
    hill_slope: 2.0

  hydrogen_peroxide:
    name: "Hydrogen Peroxide"
    stress_axis: "oxidative"
    intensity: 1.2
    ec50_uM: 100.0
    hill_slope: 2.0

  tunicamycin:
    name: "Tunicamycin"
    stress_axis: "er_stress"
    intensity: 1.0
    ec50_uM: 1.0
    hill_slope: 1.8

  thapsigargin:
    name: "Thapsigargin"
    stress_axis: "er_stress"
    intensity: 1.1
    ec50_uM: 0.5
    hill_slope: 2.2

  etoposide:
    name: "Etoposide"
    stress_axis: "dna_damage"
    intensity: 1.0
    ec50_uM: 10.0
    hill_slope: 1.6

  cccp:
    name: "CCCP"
    stress_axis: "mitochondrial"
    intensity: 1.0
    ec50_uM: 5.0
    hill_slope: 2.0

  CCCP:
    name: "CCCP"
    stress_axis: "mitochondrial"
    intensity: 1.0
    ec50_uM: 5.0
    hill_slope: 2.0

  oligomycin_a:
    name: "Oligomycin A"
    stress_axis: "mitochondrial"
    intensity: 0.9
    ec50_uM: 1.0
    hill_slope: 1.7

  oligomycin:
    name: "Oligomycin A"
    stress_axis: "mitochondrial"
    intensity: 0.9
    ec50_uM: 1.0
    hill_slope: 1.7

  two_deoxy_d_glucose:
    name: "2-Deoxy-D-Glucose"
    stress_axis: "mitochondrial"
    intensity: 0.7
    ec50_uM: 1000.0
    hill_slope: 1.2

  mg132:
    name: "MG132"
    stress_axis: "proteasome"
    intensity: 1.0
    ec50_uM: 1.0
    hill_slope: 1.9

  MG132:
    name: "MG132"
    stress_axis: "proteasome"
    intensity: 1.0
    ec50_uM: 1.0
    hill_slope: 1.9

  nocodazole:
    name: "Nocodazole"
    stress_axis: "microtubule"
    intensity: 1.0
    ec50_uM: 0.5
    hill_slope: 2.1

  paclitaxel:
    name: "Paclitaxel"
    stress_axis: "microtubule"
    intensity: 1.1
    ec50_uM: 0.01
    hill_slope: 2.0

  cisplatin:
    name: "Cisplatin"
    stress_axis: "dna_damage"
    intensity: 1.2
    ec50_uM: 5.0
    hill_slope: 1.8

  doxorubicin:
    name: "Doxorubicin"
    stress_axis: "dna_damage"
    intensity: 1.3
    ec50_uM: 0.5
    hill_slope: 2.0

  staurosporine:
    name: "Staurosporine"
    stress_axis: "dna_damage"
    intensity: 1.5
    ec50_uM: 0.1
    hill_slope: 2.5

  tbhp:
    name: "tert-Butyl hydroperoxide"
    stress_axis: "oxidative"
    intensity: 1.0
    ec50_uM: 80.0
    hill_slope: 2.0

# Baseline morphology per cell line (arbitrary units)
baseline_morphology:
  A549:
    er: 100.0
    mito: 150.0
    nucleus: 200.0
    actin: 120.0
    rna: 180.0

  HepG2:
    er: 130.0      # Hepatocytes have high ER
    mito: 180.0    # High metabolic activity
    nucleus: 190.0
    actin: 110.0
    rna: 200.0     # High protein synthesis

  U2OS:
    er: 95.0
    mito: 140.0
    nucleus: 210.0  # Large nuclei
    actin: 130.0
    rna: 170.0

# ATP viability baseline (luminescence units)
baseline_atp:
  A549: 50000.0
  HepG2: 60000.0  # Higher metabolic activity
  U2OS: 45000.0

# Technical variance parameters (coefficient of variation)
# Tuned so DMSO controls have ~2-3% total CV (realistic for high-content screening)
technical_noise:
  plate_cv: 0.010     # 1% plate-to-plate variation
  day_cv: 0.015       # 1.5% day-to-day variation
  operator_cv: 0.008  # 0.8% operator-to-operator variation
  well_cv: 0.015      # 1.5% well-to-well (measurement noise)
  edge_effect: 0.12   # 12% signal reduction for edge wells (evaporation, temperature)
  well_failure_rate: 0.02  # 2% of wells randomly fail (bubbles, contamination, pipetting errors)

# Well failure modes (when well_failure_rate triggers)
well_failure_modes:
  bubble:
    probability: 0.40  # 40% of failures are bubbles
    effect: "no_signal"  # Imaging fails, all channels near zero
  contamination:
    probability: 0.25  # 25% of failures are contamination
    effect: "outlier_high"  # Abnormally high signal (bacteria/yeast growth)
  pipetting_error:
    probability: 0.20  # 20% of failures are pipetting errors
    effect: "outlier_low"  # Wrong volume, low cell count
  staining_failure:
    probability: 0.10  # 10% of failures are staining issues
    effect: "partial_signal"  # Some channels fail, others OK
  cross_contamination:
    probability: 0.05  # 5% of failures are cross-contamination
    effect: "mixed_signal"  # Signal from neighboring well

# Biological variance
biological_noise:
  cell_line_cv: 0.020  # 2% biological variation (intrinsic cell-to-cell differences)
  dose_response_cv: 0.10  # 10% dose-response variability (unused for now)
  stress_cv_multiplier: 2.0  # Stressed cells show 2× higher CV (heterogeneous death timing)

# Sentinel definitions (fixed control wells on every plate)
sentinels:
  dmso:
    compound: "DMSO"
    dose_uM: 0.0
    well_positions: ["A1", "A12", "H1", "H12"]  # Corners of 96-well plate

  mild_stress:
    compound: "tBHQ"
    dose_uM: 10.0
    well_positions: ["A6", "H6"]  # Middle edges

  strong_stress:
    compound: "tunicamycin"
    dose_uM: 2.0
    well_positions: ["D6", "E6"]  # Middle of plate

# Dose grid for Phase 0
dose_grid:
  vehicle: 0.0
  low: 0.1      # Fraction of EC50
  mid: 1.0      # At EC50
  high: 10.0    # 10x EC50

# Timepoints (hours post-treatment)
timepoints:
  early: 12
  late: 48

# Plate layout
plate_format: 96  # 96-well plates
wells_per_condition: 3  # Technical replicates per plate
